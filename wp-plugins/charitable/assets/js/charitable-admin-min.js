CHARITABLE_ADMIN=window.CHARITABLE_ADMIN||{},function(exports,$){if($.fn.datepicker){exports.Datepicker=function(t){this.$el=t;var a={dateFormat:this.$el.data("format")||"yy/mm/dd",minDate:this.$el.data("min-date")||"",beforeShow:function(t,a){$("#ui-datepicker-div").addClass("charitable-datepicker-table")}};this.$el.datepicker(a),this.$el.data("date")&&this.$el.datepicker("setDate",this.$el.data("date")),this.$el.data("min-date")&&this.$el.datepicker("option","minDate",this.$el.data("min-date"))}}}(CHARITABLE_ADMIN,jQuery),function(exports,$){exports.Settings=function(t){var a=[];show_setting=function(t,a){var e,i="!"===t[0],n=i?t.slice(1):t;return e="checked"===n?a.is(":checked"):"selected"===n?a.selected():a.val()===n,i?!e:e},toggle_setting=function(t,a){var e=function(t){var a=t.parents("tr");return a.length?a.first():t}(t),i=get_setting_value(t),n=show_setting(i,a);e.toggle(n)},get_setting_value=function(t){var a=t.data("trigger-value");return void 0===a&&(a=t.data("show-only-if-value")),a},toggle_options=function(t,a){var e,i=a.val(),n=t.data("trigger-value");("radio"!==a.attr("type")||a.prop("checked"))&&n.hasOwnProperty(i)&&(e=n[i],t.find("input").each((function(){var t=$(this),a=!(t.val()in e);a&&t.prop("checked",!1),t.prop("disabled",a).trigger("change")})))},get_trigger_id=function(t){var a=t.data("trigger-key");return void 0===a&&(a="#"+t.data("show-only-if-key")),a},get_trigger=function(t){return"#"===t[0]?$(t):$('[name="'+t+'"]')},get_change_type=function(t){var a=t.data("trigger-change-type");return void 0===a&&(a="visibility"),a},on_change=function(){var t=$(this);t.data("trigger_idx").forEach((function(e){a[e].settings.forEach((function(a){var e=get_change_type(a);"visibility"===e?toggle_setting(a,t):"options"===e&&toggle_options(a,t)}))}))},this.$el=t;var e=0;this.$el.find("[data-trigger-key],[data-show-only-if-key]").each((function(){var t=$(this),i=get_trigger_id(t);a[i];void 0===a[i]&&(a[e]={trigger_id:i,settings:[]}),a[e].settings.push(t),e+=1})),a.forEach((function(t,a){var e=get_trigger(t.trigger_id),i=e.data("trigger_idx");void 0===i&&(i=[]),i.push(a),e.data("trigger_idx",i),e.on("change",on_change),e.trigger("change")}))}}(CHARITABLE_ADMIN,jQuery),function($){var t=function(){var t=$("#campaign_allow_custom_donations"),a=$(".charitable-campaign-suggested-donations tbody tr:not(.to-copy)"),e=a.length>1||!1===a.first().hasClass("no-suggested-amounts");t.prop("disabled",!e),e||t.prop("checked",!0)},a=function(){$(".charitable-campaign-suggested-donations tbody").each((function(){$(this).children("tr").not(".no-suggested-amounts .to-copy").each((function(t){$(this).find('input[name="_campaign_suggested_donations_default[]"').val(t),$(this).data("index",t),$(this).find("input").each((function(a){this.name=this.name.replace(/(\[\d\])/,"["+t+"]")}))}))}))},e=function(){if("undefined"!=typeof accounting){$("body").on("change",".currency-input",(function(){var t=function(t){return Math.abs(parseFloat(accounting.unformat(t,CHARITABLE.currency_format_decimal_sep)))}($(this).val());$.trim(t)>0&&$(this).val(function(t){return accounting.formatMoney(t,{symbol:"",decimal:CHARITABLE.currency_format_decimal_sep,thousand:CHARITABLE.currency_format_thousand_sep,precision:CHARITABLE.currency_format_num_decimals,format:CHARITABLE.currency_format}).trim()}(t))})),$(".currency-input").trigger("change")}};$(document).ready((function(){var i,n,o,c,r,s;$("body").on("click","th.default_amount-col a",(function(t){t.stopPropagation(),$(".default_amount-col input").prop("checked",!1),$(this).blur()})),$("a#charitable-modify-keys").on("click",(function(t){t.stopPropagation();var a=$(this);a.css("pointer-events","none"),a.css("opacity","0.25");var e={action:"charitable-"+$(this).data("charitable-action"),args:$(this).data("charitable-args"),nonce:$(this).data("nonce")};$.ajax({type:"POST",data:e,dataType:"json",url:ajaxurl,xhrFields:{withCredentials:!0},success:function(t){a.closest("tr").after(t.data),a.closest("tr").hide()}}).fail((function(t){window.console&&window.console.log&&(a.css("pointer-events","all"),a.css("opacity","1.0"))}))})),CHARITABLE_ADMIN.Datepicker&&$(".charitable-datepicker").each((function(){CHARITABLE_ADMIN.Datepicker($(this))})),$(document).one("submit","#charitable-campaigns-filter-modal form",(function(t){t.preventDefault();var a=!1;$("#charitable-campaigns-filter-modal form input[type=text]").each((function(){""!==$(this).val().trim()&&(isValidDate=function(t){const a=/^(\d{4})(\/|-)(\d{1,2})(\/|-)(\d{1,2})$/;if(null===t.match(a))return!1;const e=new Date(t),i=e.getTime();if("number"!=typeof i||Number.isNaN(i))return!1;return e.toISOString().replace(/\-/g,"/").startsWith(t)}($(this).val()),!1===isValidDate&&(a=!0,$(this).val("")))})),!0===a?alert("Invalid Date Format"):$(this).submit()})),$("#charitable-settings, body.post-type-campaign form#post, body.post-type-donation form#post").each((function(){CHARITABLE_ADMIN.Settings($(this))})),$("body.post-type-campaign .handlediv, body.post-type-donation .handlediv").remove(),$("body.post-type-campaign .hndle, body.post-type-donation .hndle").removeClass("hndle ui-sortable-handle").addClass("postbox-title"),function(){var t=$("#charitable-campaign-advanced-metabox");t.tabs();var a=t.find(".charitable-tabs").height();t.find(".ui-tabs-panel").each((function(){$(this).css("min-height",a)}))}(),$(".charitable-campaign-suggested-donations tbody").sortable({items:"tr:not(.to-copy)",handle:".handle",stop:function(t,e){a()}}),t(),$("[data-charitable-action]").on("click",(function(t){var a=$(this).data("charitable-args")||{},e="charitable-"+$(this).data("charitable-action");return $.post(ajaxurl,{action:e,data:a},(function(t){})),!1})),$("[data-charitable-toggle]").on("click",(function(t){var a=$(this).data("charitable-toggle"),e=$(this).attr("data-charitable-toggle-text");return e&&e.length&&($(this).attr("data-charitable-toggle-text",$(this).text()),$(this).text(e)),$("#"+a).toggle(),!1})),(i=$("#charitable_dashboard_donations")).length&&$.ajax({type:"GET",data:{action:"charitable_load_dashboard_donations_widget"},url:ajaxurl,success:function(t){i.find(".inside").html(t)}}),$("#campaign_end_date").on("change",(function(){var t=$(this),a=t.val(),e=t.siblings(".charitable-end-time"),i=t.siblings("#campaign_end_time");""!==a&&a?(e.text("@ 23:59 PM").show(),i.val("23:59:59")):(e.hide(),i.val(0))})),(r=$(".charitable-actions-form-wrapper")).length&&(n=r.find(".charitable-action-select"),o=r.find(".charitable-actions-submit"),c=o.find("button"),o.hide(),n.on("change",(function(){var t=n.val(),a=n.find("option:selected").data("button-text");""!==t?(r.find(".charitable-action-fields").each((function(){var a=$(this);a.toggle(t===a.data("type"))})),a?c.text(a):c.text(c.prop("title")),o.show()):o.hide()}))),$.fn.select2&&$(".select2 select, select.select2").select2(),$(".charitable-admin-donation-form #donor-id").on("change",(function(){var t,a,e=$(this).val();""!==e&&"new"!==e&&((t=$("#charitable-user-fields-wrap")).addClass("loading-data"),data={action:"charitable_get_donor_data",donor_id:e,fields:("object"==typeof s||(s=[],$("#charitable-user-fields-wrap").find("select,input,textarea").each((function(){s.push(this.name)}))),s),nonce:$(this).data("nonce")},$.ajax({type:"POST",data:data,dataType:"json",url:ajaxurl,xhrFields:{withCredentials:!0},success:function(e){if(e.success)for(a in e.data)t.find("[name="+a+"]").val(e.data[a]);t.removeClass("loading-data")}}).fail((function(a){window.console&&window.console.log&&t.removeClass("loading-data")})))})),e(),$("#charitable-settings-connect-btn").on("click",(function(t){var a={action:"charitable_license_check",license:$('input[name="license-key"]').val(),nonce:$('input[name="_wpnonce"]').val(),chartiable_action:$(this).data("action")};return"verify"===a.chartiable_action?$(this).html("Verifying..."):$(this).html("Deactivating..."),$(this).prop("disabled",!0),$.ajax({type:"POST",data:a,dataType:"json",url:ajaxurl,xhrFields:{withCredentials:!0},success:function(t){t.success&&(!0===t.data.valid?($("#charitable-license-message").html(t.data.message),void 0===charitable_admin.admin_url?window.location.href=charitable_admin.admin_url+"admin.php?page=charitable-settings&tab=general&valid=valid":location.reload()):($("#charitable-license-message").html(t.data.message),void 0!==charitable_admin.admin_url?!0===t.data.license_limit?window.location.href=charitable_admin.admin_url+"admin.php?page=charitable-settings&tab=general&valid=invalid&license_limit=true":!1===t.data.comm_success?window.location.href=charitable_admin.admin_url+"admin.php?page=charitable-settings&tab=general&valid=invalid&comm_success=false":"verify"===a.chartiable_action?window.location.href=charitable_admin.admin_url+"admin.php?page=charitable-settings&tab=general&valid=invalid":window.location.href=charitable_admin.admin_url+"admin.php?page=charitable-settings&tab=general&valid=success":location.reload()))}}).fail((function(t){window.console&&window.console.log})),!1})),$("[data-charitable-add-row]").on("click",(function(){return"suggested-amount"===$(this).data("charitable-add-row")&&function(e){var i=e.closest(".charitable-campaign-suggested-donations").find("tbody"),n=i.find("tr.to-copy").clone().removeClass("to-copy hidden");i.find(".no-suggested-amounts").hide(),i.append(n),a(),t()}($(this)),!1})),$(".charitable-campaign-suggested-donations").on("click",".charitable-delete-row",(function(){return function(e){e.closest("tr").remove();var i=e.closest(".charitable-campaign-suggested-donations").find("tbody");1==i.find("tr:not(.to-copy)").length&&i.find(".no-suggested-amounts").removeClass("hidden").show(),a(),t()}($(this)),!1})),$("body").on("click","[data-campaign-benefactor-delete]",(function(){var t=$(this).parents(".charitable-benefactor"),a={action:"charitable_delete_benefactor",benefactor_id:$(this).data("campaign-benefactor-delete"),nonce:$(this).data("nonce")};return $.ajax({type:"POST",data:a,dataType:"json",url:ajaxurl,xhrFields:{withCredentials:!0},success:function(a){a.deleted&&t.remove()}}).fail((function(t){window.console&&window.console.log})),!1})),$("#change-donation-status").on("change",(function(){$(this).parents("form").submit()}))}))}(jQuery);